/* ---------- Font (vintage typewriter) ---------- */
@import url('https://fonts.googleapis.com/css2?family=Special+Elite&display=swap');

/* ---------- Base ---------- */
* { box-sizing: border-box; }
html, body { height: 100%; margin: 0; }
body {
  font-family: "Special Elite", "Courier New", Courier, monospace;
  color: #f7f7f7;
  background-image: url("images/1881.jpg");
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
}

/* ---------- Layout ---------- */
.page {
  min-height: 100dvh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 6vw;
  text-align: center;
}

.poem {
  white-space: pre-line;
  font-size: clamp(0.9rem, 1.8vw + 0.2rem, 1.3rem);
  line-height: 1.35;
  max-width: 50ch;
  text-wrap: balance;
  text-shadow: 0 1px 6px rgba(0,0,0,0.55);
  padding: 0;
}

/* ---------- Word atoms (injected by JS) ---------- */
.w {
  display: inline-block;            /* needed for flying/hover */
  margin-right: 0.25ch;             /* spacing like a space */
  transition: color 120ms ease;
  cursor: pointer;
}

/* Hover: all words go red (except .burn overrides below) */
.w:hover { color: #b20e0e; }

/* Line breaks injected by JS */
.br { display: block; height: 0; }

/* ---------- “burn” special hover (redder & darker) ---------- */
.burn { position: relative; padding: 0.05em 0.2em; }
.burn:hover { color: #8b0000; } /* deep dark red for text */

.burn:hover::before {
  content: "";
  position: absolute;
  inset: -0.18em -0.22em;
  pointer-events: none;
  /* deeper reds / darker char */
  background:
    radial-gradient(120% 80% at 10% 40%, rgba(220,40,30,0.45) 0 15%, rgba(120,30,25,0.65) 16% 28%, transparent 29%),
    radial-gradient(120% 80% at 80% 30%, rgba(200,25,20,0.40) 0 12%, rgba(90,25,20,0.65) 13% 26%, transparent 27%),
    radial-gradient(90% 70% at 50% 100%, rgba(255,90,60,0.35) 0 10%, rgba(60,15,12,0.7) 11% 22%, transparent 23%),
    radial-gradient(100% 80% at 50% 0%, rgba(210,40,30,0.38) 0 10%, rgba(70,20,18,0.75) 11% 24%, transparent 25%);
  mix-blend-mode: multiply;
  filter: blur(0.6px) contrast(1.05);
  animation: ember 1.1s ease-in-out infinite alternate;
  border-radius: 3px;
  opacity: 0.95;
}

.burn:hover::after {
  content: "";
  position: absolute;
  inset: -0.08em -0.1em;
  border: 1.5px solid rgba(25,10,10,0.9);
  box-shadow:
    0 0 1px rgba(0,0,0,0.8),
    0 0 6px rgba(200,40,30,0.18);
  border-radius: 2px;
  pointer-events: none;
}

@keyframes ember {
  0%   { opacity: 0.8; transform: translateY(0) scale(1); }
  50%  { opacity: 1;   transform: translateY(-0.5px) scale(1.01); }
  100% { opacity: 0.9; transform: translateY(-0.3px) scale(1.005); }
}

/* ---------- Click: tremble → enlarge → fly away ---------- */
.w.flying {
  z-index: 2;
  /* two staged animations: shake then fly */
  animation:
    shake 0.35s ease-in-out both,
    fly 0.9s ease-in 0.35s forwards;
  will-change: transform, opacity;
}

@keyframes shake {
  0%   { transform: translate(0,0) rotate(0) scale(1); }
  25%  { transform: translate(-1px, 0.6px) rotate(-1.2deg) scale(1.05); }
  50%  { transform: translate(1px, -0.6px) rotate(1.4deg) scale(1.1); }
  75%  { transform: translate(-1px, 0.4px) rotate(-0.8deg) scale(1.15); }
  100% { transform: translate(0,0) rotate(0) scale(1.18); }
}

@keyframes fly {
  to {
    /* set by CSS variables from JS */
    transform: translate(var(--tx, 0px), var(--ty, -200px)) rotate(var(--rz, 20deg)) scale(1.6);
    opacity: 0;
  }
}

/* ---------- Next button ---------- */
#nextBtn {
  position: fixed;
  left: 50%;
  bottom: 28px;
  transform: translateX(-50%);
  padding: 10px 16px;
  border: 1.5px solid #f2e9e4;
  color: #f2e9e4;
  text-decoration: none;
  font-size: 0.95rem;
  letter-spacing: 0.04em;
  text-transform: lowercase;
  border-radius: 999px;
  background: rgba(0,0,0,0.25);
  backdrop-filter: blur(2px);
  opacity: 0;
  pointer-events: none;
  transition: opacity 250ms ease, transform 250ms ease;
}
#nextBtn.show {
  opacity: 1;
  pointer-events: auto;
}
#nextBtn:hover { transform: translateX(-50%) scale(1.05); }

/* ---------- Reduced motion ---------- */
@media (prefers-reduced-motion: reduce) {
  .w.flying { animation: none; }
  .burn:hover::before { animation: none; }
}